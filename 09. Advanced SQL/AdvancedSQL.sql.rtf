{\rtf1\ansi\ansicpg1251\cocoartf2706
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
\paperw11900\paperh16840\margl1440\margr1440\vieww34360\viewh21600\viewkind0
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\partightenfactor0

\f0\fs24 \cf0 1. \uc0\u1053 \u1072 \u1081 \u1076 \u1080 \u1090 \u1077  \u1082 \u1086 \u1083 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1086  \u1074 \u1086 \u1087 \u1088 \u1086 \u1089 \u1086 \u1074 , \u1082 \u1086 \u1090 \u1086 \u1088 \u1099 \u1077  \u1085 \u1072 \u1073 \u1088 \u1072 \u1083 \u1080  \u1073 \u1086 \u1083 \u1100 \u1096 \u1077  300 \u1086 \u1095 \u1082 \u1086 \u1074  \u1080 \u1083 \u1080  \u1082 \u1072 \u1082  \u1084 \u1080 \u1085 \u1080 \u1084 \u1091 \u1084  100 \u1088 \u1072 \u1079  \u1073 \u1099 \u1083 \u1080  \u1076 \u1086 \u1073 \u1072 \u1074 \u1083 \u1077 \u1085 \u1099  \u1074  \'ab\u1047 \u1072 \u1082 \u1083 \u1072 \u1076 \u1082 \u1080 \'bb.\
\
SELECT COUNT(p.id)\
FROM stackoverflow.posts p\
LEFT JOIN stackoverflow.post_types pt ON pt.id = p.post_type_id\
WHERE pt.type = 'Question' AND (favorites_count >= 100 OR score > 300)\
\
\
2. \uc0\u1057 \u1082 \u1086 \u1083 \u1100 \u1082 \u1086  \u1074  \u1089 \u1088 \u1077 \u1076 \u1085 \u1077 \u1084  \u1074  \u1076 \u1077 \u1085 \u1100  \u1079 \u1072 \u1076 \u1072 \u1074 \u1072 \u1083 \u1080  \u1074 \u1086 \u1087 \u1088 \u1086 \u1089 \u1086 \u1074  \u1089  1 \u1087 \u1086  18 \u1085 \u1086 \u1103 \u1073 \u1088 \u1103  2008 \u1074 \u1082 \u1083 \u1102 \u1095 \u1080 \u1090 \u1077 \u1083 \u1100 \u1085 \u1086 ? \u1056 \u1077 \u1079 \u1091 \u1083 \u1100 \u1090 \u1072 \u1090  \u1086 \u1082 \u1088 \u1091 \u1075 \u1083 \u1080 \u1090 \u1077  \u1076 \u1086  \u1094 \u1077 \u1083 \u1086 \u1075 \u1086  \u1095 \u1080 \u1089 \u1083 \u1072 .\
\
WITH\
         count_posts AS \
         (SELECT DATE_TRUNC('DAY',p.creation_date)::DATE,\
                          COUNT(p.id) count_posts\
         FROM stackoverflow.posts p\
         LEFT JOIN stackoverflow.post_types pt ON pt.id = p.post_type_id\
         WHERE pt.type = 'Question' \
        AND DATE_TRUNC('DAY',p.creation_date)::DATE BETWEEN '2008-11-01' AND '2008-11-18'\
        GROUP BY DATE_TRUNC('DAY',p.creation_date)::DATE)\
\
SELECT ROUND(AVG(count_posts))\
FROM count_posts\
\
\
3. \uc0\u1057 \u1082 \u1086 \u1083 \u1100 \u1082 \u1086  \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1077 \u1081  \u1087 \u1086 \u1083 \u1091 \u1095 \u1080 \u1083 \u1080  \u1079 \u1085 \u1072 \u1095 \u1082 \u1080  \u1089 \u1088 \u1072 \u1079 \u1091  \u1074  \u1076 \u1077 \u1085 \u1100  \u1088 \u1077 \u1075 \u1080 \u1089 \u1090 \u1088 \u1072 \u1094 \u1080 \u1080 ? \u1042 \u1099 \u1074 \u1077 \u1076 \u1080 \u1090 \u1077  \u1082 \u1086 \u1083 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1086  \u1091 \u1085 \u1080 \u1082 \u1072 \u1083 \u1100 \u1085 \u1099 \u1093  \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1077 \u1081 .\
\
SELECT COUNT(DISTINCT u.id)\
FROM stackoverflow.users u\
JOIN stackoverflow.badges b ON b.user_id = u.id\
WHERE b.creation_date::date = u.creation_date::date\
\
\
4. \uc0\u1057 \u1082 \u1086 \u1083 \u1100 \u1082 \u1086  \u1091 \u1085 \u1080 \u1082 \u1072 \u1083 \u1100 \u1085 \u1099 \u1093  \u1087 \u1086 \u1089 \u1090 \u1086 \u1074  \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1103  \u1089  \u1080 \u1084 \u1077 \u1085 \u1077 \u1084  Joel Coehoorn \u1087 \u1086 \u1083 \u1091 \u1095 \u1080 \u1083 \u1080  \u1093 \u1086 \u1090 \u1103  \u1073 \u1099  \u1086 \u1076 \u1080 \u1085  \u1075 \u1086 \u1083 \u1086 \u1089 ?\
\
SELECT COUNT(DISTINCT p.id)\
FROM stackoverflow.users u\
JOIN stackoverflow.posts p ON u.id = p.user_id\
JOIN stackoverflow.votes v ON p.id = v.post_id\
WHERE u.display_name = 'Joel Coehoorn' \
HAVING COUNT(v.id) >= 1\
 \
\
5. \uc0\u1042 \u1099 \u1075 \u1088 \u1091 \u1079 \u1080 \u1090 \u1077  \u1074 \u1089 \u1077  \u1087 \u1086 \u1083 \u1103  \u1090 \u1072 \u1073 \u1083 \u1080 \u1094 \u1099  vote_types. \u1044 \u1086 \u1073 \u1072 \u1074 \u1100 \u1090 \u1077  \u1082  \u1090 \u1072 \u1073 \u1083 \u1080 \u1094 \u1077  \u1087 \u1086 \u1083 \u1077  rank, \u1074  \u1082 \u1086 \u1090 \u1086 \u1088 \u1086 \u1077  \u1074 \u1086 \u1081 \u1076 \u1091 \u1090  \u1085 \u1086 \u1084 \u1077 \u1088 \u1072  \u1079 \u1072 \u1087 \u1080 \u1089 \u1077 \u1081  \u1074  \u1086 \u1073 \u1088 \u1072 \u1090 \u1085 \u1086 \u1084  \u1087 \u1086 \u1088 \u1103 \u1076 \u1082 \u1077 . \u1058 \u1072 \u1073 \u1083 \u1080 \u1094 \u1072  \u1076 \u1086 \u1083 \u1078 \u1085 \u1072  \u1073 \u1099 \u1090 \u1100  \u1086 \u1090 \u1089 \u1086 \u1088 \u1090 \u1080 \u1088 \u1086 \u1074 \u1072 \u1085 \u1072  \u1087 \u1086  \u1087 \u1086 \u1083 \u1102  id.\
\
WITH\
         RANK AS \
        (SELECT *, \
         ROW_NUMBER() OVER(ORDER BY id DESC) rank\
         FROM stackoverflow.vote_types)\
\
SELECT *\
FROM RANK\
ORDER BY rank DESC\
\
\
6. \uc0\u1054 \u1090 \u1073 \u1077 \u1088 \u1080 \u1090 \u1077  10 \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1077 \u1081 , \u1082 \u1086 \u1090 \u1086 \u1088 \u1099 \u1077  \u1087 \u1086 \u1089 \u1090 \u1072 \u1074 \u1080 \u1083 \u1080  \u1073 \u1086 \u1083 \u1100 \u1096 \u1077  \u1074 \u1089 \u1077 \u1075 \u1086  \u1075 \u1086 \u1083 \u1086 \u1089 \u1086 \u1074  \u1090 \u1080 \u1087 \u1072  Close. \u1054 \u1090 \u1086 \u1073 \u1088 \u1072 \u1079 \u1080 \u1090 \u1077  \u1090 \u1072 \u1073 \u1083 \u1080 \u1094 \u1091  \u1080 \u1079  \u1076 \u1074 \u1091 \u1093  \u1087 \u1086 \u1083 \u1077 \u1081 : \u1080 \u1076 \u1077 \u1085 \u1090 \u1080 \u1092 \u1080 \u1082 \u1072 \u1090 \u1086 \u1088 \u1086 \u1084  \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1103  \u1080  \u1082 \u1086 \u1083 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1086 \u1084  \u1075 \u1086 \u1083 \u1086 \u1089 \u1086 \u1074 . \u1054 \u1090 \u1089 \u1086 \u1088 \u1090 \u1080 \u1088 \u1091 \u1081 \u1090 \u1077  \u1076 \u1072 \u1085 \u1085 \u1099 \u1077  \u1089 \u1085 \u1072 \u1095 \u1072 \u1083 \u1072  \u1087 \u1086  \u1091 \u1073 \u1099 \u1074 \u1072 \u1085 \u1080 \u1102  \u1082 \u1086 \u1083 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1072  \u1075 \u1086 \u1083 \u1086 \u1089 \u1086 \u1074 , \u1087 \u1086 \u1090 \u1086 \u1084  \u1087 \u1086  \u1091 \u1073 \u1099 \u1074 \u1072 \u1085 \u1080 \u1102  \u1079 \u1085 \u1072 \u1095 \u1077 \u1085 \u1080 \u1103  \u1080 \u1076 \u1077 \u1085 \u1090 \u1080 \u1092 \u1080 \u1082 \u1072 \u1090 \u1086 \u1088 \u1072  \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1103 .\
\
SELECT u.id users, \
              COUNT(v.id)  count_votes\
FROM stackoverflow.users u\
JOIN stackoverflow.votes v ON u.id = v.user_id\
JOIN stackoverflow.vote_types vt ON v.vote_type_id = vt.id\
WHERE vt.name = 'Close'\
GROUP BY users\
ORDER BY count_votes DESC\
LIMIT 10;\
\
\
7. \uc0\u1054 \u1090 \u1073 \u1077 \u1088 \u1080 \u1090 \u1077  10 \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1077 \u1081  \u1087 \u1086  \u1082 \u1086 \u1083 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1091  \u1079 \u1085 \u1072 \u1095 \u1082 \u1086 \u1074 , \u1087 \u1086 \u1083 \u1091 \u1095 \u1077 \u1085 \u1085 \u1099 \u1093  \u1074  \u1087 \u1077 \u1088 \u1080 \u1086 \u1076  \u1089  15 \u1085 \u1086 \u1103 \u1073 \u1088 \u1103  \u1087 \u1086  15 \u1076 \u1077 \u1082 \u1072 \u1073 \u1088 \u1103  2008 \u1075 \u1086 \u1076 \u1072  \u1074 \u1082 \u1083 \u1102 \u1095 \u1080 \u1090 \u1077 \u1083 \u1100 \u1085 \u1086 .\
\uc0\u1054 \u1090 \u1086 \u1073 \u1088 \u1072 \u1079 \u1080 \u1090 \u1077  \u1085 \u1077 \u1089 \u1082 \u1086 \u1083 \u1100 \u1082 \u1086  \u1087 \u1086 \u1083 \u1077 \u1081 :\
		\uc0\u1080 \u1076 \u1077 \u1085 \u1090 \u1080 \u1092 \u1080 \u1082 \u1072 \u1090 \u1086 \u1088  \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1103 ;\
		\uc0\u1095 \u1080 \u1089 \u1083 \u1086  \u1079 \u1085 \u1072 \u1095 \u1082 \u1086 \u1074 ;\
		\uc0\u1084 \u1077 \u1089 \u1090 \u1086  \u1074  \u1088 \u1077 \u1081 \u1090 \u1080 \u1085 \u1075 \u1077  \'97 \u1095 \u1077 \u1084  \u1073 \u1086 \u1083 \u1100 \u1096 \u1077  \u1079 \u1085 \u1072 \u1095 \u1082 \u1086 \u1074 , \u1090 \u1077 \u1084  \u1074 \u1099 \u1096 \u1077  \u1088 \u1077 \u1081 \u1090 \u1080 \u1085 \u1075 .\
\uc0\u1055 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1103 \u1084 , \u1082 \u1086 \u1090 \u1086 \u1088 \u1099 \u1077  \u1085 \u1072 \u1073 \u1088 \u1072 \u1083 \u1080  \u1086 \u1076 \u1080 \u1085 \u1072 \u1082 \u1086 \u1074 \u1086 \u1077  \u1082 \u1086 \u1083 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1086  \u1079 \u1085 \u1072 \u1095 \u1082 \u1086 \u1074 , \u1087 \u1088 \u1080 \u1089 \u1074 \u1086 \u1081 \u1090 \u1077  \u1086 \u1076 \u1085 \u1086  \u1080  \u1090 \u1086  \u1078 \u1077  \u1084 \u1077 \u1089 \u1090 \u1086  \u1074  \u1088 \u1077 \u1081 \u1090 \u1080 \u1085 \u1075 \u1077 .\
\uc0\u1054 \u1090 \u1089 \u1086 \u1088 \u1090 \u1080 \u1088 \u1091 \u1081 \u1090 \u1077  \u1079 \u1072 \u1087 \u1080 \u1089 \u1080  \u1087 \u1086  \u1082 \u1086 \u1083 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1091  \u1079 \u1085 \u1072 \u1095 \u1082 \u1086 \u1074  \u1087 \u1086  \u1091 \u1073 \u1099 \u1074 \u1072 \u1085 \u1080 \u1102 , \u1072  \u1079 \u1072 \u1090 \u1077 \u1084  \u1087 \u1086  \u1074 \u1086 \u1079 \u1088 \u1072 \u1089 \u1090 \u1072 \u1085 \u1080 \u1102  \u1079 \u1085 \u1072 \u1095 \u1077 \u1085 \u1080 \u1103  \u1080 \u1076 \u1077 \u1085 \u1090 \u1080 \u1092 \u1080 \u1082 \u1072 \u1090 \u1086 \u1088 \u1072  \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1103 .\
\
SELECT user_id,\
       COUNT(id),\
       DENSE_RANK() OVER( ORDER BY COUNT(id) DESC)\
FROM stackoverflow.badges\
WHERE DATE_TRUNC('day',creation_date)::date BETWEEN '2008-11-15' AND '2008-12-15'\
GROUP BY user_id\
LIMIT 10\
\
\
8. \uc0\u1057 \u1082 \u1086 \u1083 \u1100 \u1082 \u1086  \u1074  \u1089 \u1088 \u1077 \u1076 \u1085 \u1077 \u1084  \u1086 \u1095 \u1082 \u1086 \u1074  \u1087 \u1086 \u1083 \u1091 \u1095 \u1072 \u1077 \u1090  \u1087 \u1086 \u1089 \u1090  \u1082 \u1072 \u1078 \u1076 \u1086 \u1075 \u1086  \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1103 ?\
\uc0\u1057 \u1092 \u1086 \u1088 \u1084 \u1080 \u1088 \u1091 \u1081 \u1090 \u1077  \u1090 \u1072 \u1073 \u1083 \u1080 \u1094 \u1091  \u1080 \u1079  \u1089 \u1083 \u1077 \u1076 \u1091 \u1102 \u1097 \u1080 \u1093  \u1087 \u1086 \u1083 \u1077 \u1081 :\
		\uc0\u1079 \u1072 \u1075 \u1086 \u1083 \u1086 \u1074 \u1086 \u1082  \u1087 \u1086 \u1089 \u1090 \u1072 ;\
		\uc0\u1080 \u1076 \u1077 \u1085 \u1090 \u1080 \u1092 \u1080 \u1082 \u1072 \u1090 \u1086 \u1088  \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1103 ;\
		\uc0\u1095 \u1080 \u1089 \u1083 \u1086  \u1086 \u1095 \u1082 \u1086 \u1074  \u1087 \u1086 \u1089 \u1090 \u1072 ;\
		\uc0\u1089 \u1088 \u1077 \u1076 \u1085 \u1077 \u1077  \u1095 \u1080 \u1089 \u1083 \u1086  \u1086 \u1095 \u1082 \u1086 \u1074  \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1103  \u1079 \u1072  \u1087 \u1086 \u1089 \u1090 , \u1086 \u1082 \u1088 \u1091 \u1075 \u1083 \u1105 \u1085 \u1085 \u1086 \u1077  \u1076 \u1086  \u1094 \u1077 \u1083 \u1086 \u1075 \u1086  \u1095 \u1080 \u1089 \u1083 \u1072 .\
\uc0\u1053 \u1077  \u1091 \u1095 \u1080 \u1090 \u1099 \u1074 \u1072 \u1081 \u1090 \u1077  \u1087 \u1086 \u1089 \u1090 \u1099  \u1073 \u1077 \u1079  \u1079 \u1072 \u1075 \u1086 \u1083 \u1086 \u1074 \u1082 \u1072 , \u1072  \u1090 \u1072 \u1082 \u1078 \u1077  \u1090 \u1077 , \u1095 \u1090 \u1086  \u1085 \u1072 \u1073 \u1088 \u1072 \u1083 \u1080  \u1085 \u1086 \u1083 \u1100  \u1086 \u1095 \u1082 \u1086 \u1074 .\
\
SELECT title,\
       user_id,\
       score,\
       ROUND(AVG(score) OVER( PARTITION BY user_id))\
FROM stackoverflow.posts\
WHERE title IS NOT NULL AND score != 0\
GROUP BY title,\
                    user_id,\
                    score\
\
\
9. \uc0\u1054 \u1090 \u1086 \u1073 \u1088 \u1072 \u1079 \u1080 \u1090 \u1077  \u1079 \u1072 \u1075 \u1086 \u1083 \u1086 \u1074 \u1082 \u1080  \u1087 \u1086 \u1089 \u1090 \u1086 \u1074 , \u1082 \u1086 \u1090 \u1086 \u1088 \u1099 \u1077  \u1073 \u1099 \u1083 \u1080  \u1085 \u1072 \u1087 \u1080 \u1089 \u1072 \u1085 \u1099  \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1103 \u1084 \u1080 , \u1087 \u1086 \u1083 \u1091 \u1095 \u1080 \u1074 \u1096 \u1080 \u1084 \u1080  \u1073 \u1086 \u1083 \u1077 \u1077  1000 \u1079 \u1085 \u1072 \u1095 \u1082 \u1086 \u1074 . \u1055 \u1086 \u1089 \u1090 \u1099  \u1073 \u1077 \u1079  \u1079 \u1072 \u1075 \u1086 \u1083 \u1086 \u1074 \u1082 \u1086 \u1074  \u1085 \u1077  \u1076 \u1086 \u1083 \u1078 \u1085 \u1099  \u1087 \u1086 \u1087 \u1072 \u1089 \u1090 \u1100  \u1074  \u1089 \u1087 \u1080 \u1089 \u1086 \u1082 .\
\
SELECT title\
FROM stackoverflow.posts\
WHERE user_id IN\
(SELECT user_id\
FROM stackoverflow.badges\
GROUP BY user_id\
HAVING COUNT(id) > 1000) AND title IS NOT NULL\
\
\
10. \uc0\u1053 \u1072 \u1087 \u1080 \u1096 \u1080 \u1090 \u1077  \u1079 \u1072 \u1087 \u1088 \u1086 \u1089 , \u1082 \u1086 \u1090 \u1086 \u1088 \u1099 \u1081  \u1074 \u1099 \u1075 \u1088 \u1091 \u1079 \u1080 \u1090  \u1076 \u1072 \u1085 \u1085 \u1099 \u1077  \u1086  \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1103 \u1093  \u1080 \u1079  \u1050 \u1072 \u1085 \u1072 \u1076 \u1099  (\u1072 \u1085 \u1075 \u1083 . Canada). \u1056 \u1072 \u1079 \u1076 \u1077 \u1083 \u1080 \u1090 \u1077  \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1077 \u1081  \u1085 \u1072  \u1090 \u1088 \u1080  \u1075 \u1088 \u1091 \u1087 \u1087 \u1099  \u1074  \u1079 \u1072 \u1074 \u1080 \u1089 \u1080 \u1084 \u1086 \u1089 \u1090 \u1080  \u1086 \u1090  \u1082 \u1086 \u1083 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1072  \u1087 \u1088 \u1086 \u1089 \u1084 \u1086 \u1090 \u1088 \u1086 \u1074  \u1080 \u1093  \u1087 \u1088 \u1086 \u1092 \u1080 \u1083 \u1077 \u1081 :\
		\uc0\u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1103 \u1084  \u1089  \u1095 \u1080 \u1089 \u1083 \u1086 \u1084  \u1087 \u1088 \u1086 \u1089 \u1084 \u1086 \u1090 \u1088 \u1086 \u1074  \u1073 \u1086 \u1083 \u1100 \u1096 \u1077  \u1083 \u1080 \u1073 \u1086  \u1088 \u1072 \u1074 \u1085 \u1099 \u1084  350 \u1087 \u1088 \u1080 \u1089 \u1074 \u1086 \u1081 \u1090 \u1077  \u1075 \u1088 \u1091 \u1087 \u1087 \u1091  1;\
		\uc0\u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1103 \u1084  \u1089  \u1095 \u1080 \u1089 \u1083 \u1086 \u1084  \u1087 \u1088 \u1086 \u1089 \u1084 \u1086 \u1090 \u1088 \u1086 \u1074  \u1084 \u1077 \u1085 \u1100 \u1096 \u1077  350, \u1085 \u1086  \u1073 \u1086 \u1083 \u1100 \u1096 \u1077  \u1083 \u1080 \u1073 \u1086  \u1088 \u1072 \u1074 \u1085 \u1086  100 \'97 \u1075 \u1088 \u1091 \u1087 \u1087 \u1091  2;\
		\uc0\u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1103 \u1084  \u1089  \u1095 \u1080 \u1089 \u1083 \u1086 \u1084  \u1087 \u1088 \u1086 \u1089 \u1084 \u1086 \u1090 \u1088 \u1086 \u1074  \u1084 \u1077 \u1085 \u1100 \u1096 \u1077  100 \'97 \u1075 \u1088 \u1091 \u1087 \u1087 \u1091  3.\
\uc0\u1054 \u1090 \u1086 \u1073 \u1088 \u1072 \u1079 \u1080 \u1090 \u1077  \u1074  \u1080 \u1090 \u1086 \u1075 \u1086 \u1074 \u1086 \u1081  \u1090 \u1072 \u1073 \u1083 \u1080 \u1094 \u1077  \u1080 \u1076 \u1077 \u1085 \u1090 \u1080 \u1092 \u1080 \u1082 \u1072 \u1090 \u1086 \u1088  \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1103 , \u1082 \u1086 \u1083 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1086  \u1087 \u1088 \u1086 \u1089 \u1084 \u1086 \u1090 \u1088 \u1086 \u1074  \u1087 \u1088 \u1086 \u1092 \u1080 \u1083 \u1103  \u1080  \u1075 \u1088 \u1091 \u1087 \u1087 \u1091 . \u1055 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1080  \u1089  \u1082 \u1086 \u1083 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1086 \u1084  \u1087 \u1088 \u1086 \u1089 \u1084 \u1086 \u1090 \u1088 \u1086 \u1074  \u1084 \u1077 \u1085 \u1100 \u1096 \u1077  \u1083 \u1080 \u1073 \u1086  \u1088 \u1072 \u1074 \u1085 \u1099 \u1084  \u1085 \u1091 \u1083 \u1102  \u1085 \u1077  \u1076 \u1086 \u1083 \u1078 \u1085 \u1099  \u1074 \u1086 \u1081 \u1090 \u1080  \u1074  \u1080 \u1090 \u1086 \u1075 \u1086 \u1074 \u1091 \u1102  \u1090 \u1072 \u1073 \u1083 \u1080 \u1094 \u1091 .\
\
SELECT id,\
               views,\
               CASE\
                        WHEN views >= 350 THEN 1\
                        WHEN views < 350 AND views >= 100 THEN 2\
                        ELSE 3\
               END\
FROM stackoverflow.users\
WHERE location LIKE ('%Canada%') AND views > 0;\
\
\
11. \uc0\u1044 \u1086 \u1087 \u1086 \u1083 \u1085 \u1080 \u1090 \u1077  \u1087 \u1088 \u1077 \u1076 \u1099 \u1076 \u1091 \u1097 \u1080 \u1081  \u1079 \u1072 \u1087 \u1088 \u1086 \u1089 . \u1054 \u1090 \u1086 \u1073 \u1088 \u1072 \u1079 \u1080 \u1090 \u1077  \u1083 \u1080 \u1076 \u1077 \u1088 \u1086 \u1074  \u1082 \u1072 \u1078 \u1076 \u1086 \u1081  \u1075 \u1088 \u1091 \u1087 \u1087 \u1099  \'97 \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1077 \u1081 , \u1082 \u1086 \u1090 \u1086 \u1088 \u1099 \u1077  \u1085 \u1072 \u1073 \u1088 \u1072 \u1083 \u1080  \u1084 \u1072 \u1082 \u1089 \u1080 \u1084 \u1072 \u1083 \u1100 \u1085 \u1086 \u1077  \u1095 \u1080 \u1089 \u1083 \u1086  \u1087 \u1088 \u1086 \u1089 \u1084 \u1086 \u1090 \u1088 \u1086 \u1074  \u1074  \u1089 \u1074 \u1086 \u1077 \u1081  \u1075 \u1088 \u1091 \u1087 \u1087 \u1077 . \u1042 \u1099 \u1074 \u1077 \u1076 \u1080 \u1090 \u1077  \u1087 \u1086 \u1083 \u1103  \u1089  \u1080 \u1076 \u1077 \u1085 \u1090 \u1080 \u1092 \u1080 \u1082 \u1072 \u1090 \u1086 \u1088 \u1086 \u1084  \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1103 , \u1075 \u1088 \u1091 \u1087 \u1087 \u1086 \u1081  \u1080  \u1082 \u1086 \u1083 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1086 \u1084  \u1087 \u1088 \u1086 \u1089 \u1084 \u1086 \u1090 \u1088 \u1086 \u1074 . \u1054 \u1090 \u1089 \u1086 \u1088 \u1090 \u1080 \u1088 \u1091 \u1081 \u1090 \u1077  \u1090 \u1072 \u1073 \u1083 \u1080 \u1094 \u1091  \u1087 \u1086  \u1091 \u1073 \u1099 \u1074 \u1072 \u1085 \u1080 \u1102  \u1087 \u1088 \u1086 \u1089 \u1084 \u1086 \u1090 \u1088 \u1086 \u1074 , \u1072  \u1079 \u1072 \u1090 \u1077 \u1084  \u1087 \u1086  \u1074 \u1086 \u1079 \u1088 \u1072 \u1089 \u1090 \u1072 \u1085 \u1080 \u1102  \u1079 \u1085 \u1072 \u1095 \u1077 \u1085 \u1080 \u1103  \u1080 \u1076 \u1077 \u1085 \u1090 \u1080 \u1092 \u1080 \u1082 \u1072 \u1090 \u1086 \u1088 \u1072 .\
\
SELECT id,\
      cass, \
      max\
FROM (SELECT id, \
             cass,\
             views,\
             MAX(views) OVER( partition by cass ) max\
       FROM \
           (SELECT id,\
                    views,\
                    CASE\
                        WHEN views >= 350 THEN 1\
                        WHEN views < 350 AND views >= 100 THEN 2\
                        ELSE 3\
                    END AS cass\
             FROM stackoverflow.users\
             WHERE location LIKE ('%Canada%') AND views > 0) AS GAG) AS DSA\
WHERE max = views\
ORDER BY views DESC, id\
\
\
\
\
12. \uc0\u1055 \u1086 \u1089 \u1095 \u1080 \u1090 \u1072 \u1081 \u1090 \u1077  \u1077 \u1078 \u1077 \u1076 \u1085 \u1077 \u1074 \u1085 \u1099 \u1081  \u1087 \u1088 \u1080 \u1088 \u1086 \u1089 \u1090  \u1085 \u1086 \u1074 \u1099 \u1093  \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1077 \u1081  \u1074  \u1085 \u1086 \u1103 \u1073 \u1088 \u1077  2008 \u1075 \u1086 \u1076 \u1072 . \u1057 \u1092 \u1086 \u1088 \u1084 \u1080 \u1088 \u1091 \u1081 \u1090 \u1077  \u1090 \u1072 \u1073 \u1083 \u1080 \u1094 \u1091  \u1089  \u1087 \u1086 \u1083 \u1103 \u1084 \u1080 :\
		\uc0\u1085 \u1086 \u1084 \u1077 \u1088  \u1076 \u1085 \u1103 ;\
		\uc0\u1095 \u1080 \u1089 \u1083 \u1086  \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1077 \u1081 , \u1079 \u1072 \u1088 \u1077 \u1075 \u1080 \u1089 \u1090 \u1088 \u1080 \u1088 \u1086 \u1074 \u1072 \u1085 \u1085 \u1099 \u1093  \u1074  \u1101 \u1090 \u1086 \u1090  \u1076 \u1077 \u1085 \u1100 ;\
		\uc0\u1089 \u1091 \u1084 \u1084 \u1091  \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1077 \u1081  \u1089  \u1085 \u1072 \u1082 \u1086 \u1087 \u1083 \u1077 \u1085 \u1080 \u1077 \u1084 .\
\
\
WITH \
    g as \
    (SELECT DISTINCT EXTRACT(DAY FROM creation_date) AS day,\
            COUNT(id)\
     FROM stackoverflow.users\
     WHERE DATE_TRUNC('day', creation_date) BETWEEN '2008-11-01' and '2008-11-30'\
     GROUP BY day)\
\
SELECT *,\
       SUM(count) OVER(ORDER BY day)\
FROM g\
\
\
\
13. \uc0\u1044 \u1083 \u1103  \u1082 \u1072 \u1078 \u1076 \u1086 \u1075 \u1086  \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1103 , \u1082 \u1086 \u1090 \u1086 \u1088 \u1099 \u1081  \u1085 \u1072 \u1087 \u1080 \u1089 \u1072 \u1083  \u1093 \u1086 \u1090 \u1103  \u1073 \u1099  \u1086 \u1076 \u1080 \u1085  \u1087 \u1086 \u1089 \u1090 , \u1085 \u1072 \u1081 \u1076 \u1080 \u1090 \u1077  \u1080 \u1085 \u1090 \u1077 \u1088 \u1074 \u1072 \u1083  \u1084 \u1077 \u1078 \u1076 \u1091  \u1088 \u1077 \u1075 \u1080 \u1089 \u1090 \u1088 \u1072 \u1094 \u1080 \u1077 \u1081  \u1080  \u1074 \u1088 \u1077 \u1084 \u1077 \u1085 \u1077 \u1084  \u1089 \u1086 \u1079 \u1076 \u1072 \u1085 \u1080 \u1103  \u1087 \u1077 \u1088 \u1074 \u1086 \u1075 \u1086  \u1087 \u1086 \u1089 \u1090 \u1072 . \u1054 \u1090 \u1086 \u1073 \u1088 \u1072 \u1079 \u1080 \u1090 \u1077 :\
		\uc0\u1080 \u1076 \u1077 \u1085 \u1090 \u1080 \u1092 \u1080 \u1082 \u1072 \u1090 \u1086 \u1088  \u1087 \u1086 \u1083 \u1100 \u1079 \u1086 \u1074 \u1072 \u1090 \u1077 \u1083 \u1103 ;\
		\uc0\u1088 \u1072 \u1079 \u1085 \u1080 \u1094 \u1091  \u1074 \u1086  \u1074 \u1088 \u1077 \u1084 \u1077 \u1085 \u1080  \u1084 \u1077 \u1078 \u1076 \u1091  \u1088 \u1077 \u1075 \u1080 \u1089 \u1090 \u1088 \u1072 \u1094 \u1080 \u1077 \u1081  \u1080  \u1087 \u1077 \u1088 \u1074 \u1099 \u1084  \u1087 \u1086 \u1089 \u1090 \u1086 \u1084 .\
\
WITH \
        rank AS \
        (SELECT *,\
              ROW_NUMBER() OVER(PARTITION BY user_id ORDER BY creation_date) rank\
         FROM stackoverflow.posts )\
\
SELECT rank.user_id,\
               rank.creation_date - u.creation_date\
FROM rank\
LEFT JOIN  stackoverflow.users u ON u.id = rank.user_id\
WHERE rank = 1\
\
\
1\
18\
\
\
\
}